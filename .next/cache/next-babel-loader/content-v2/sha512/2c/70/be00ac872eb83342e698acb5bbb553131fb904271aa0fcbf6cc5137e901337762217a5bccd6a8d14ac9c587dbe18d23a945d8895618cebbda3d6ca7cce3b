{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\Aji Maglanque\\\\Desktop\\\\dpsm-qa-portal\\\\pages\\\\index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport Link from 'next/link';\nimport Head from 'next/head';\nimport { Formik, Form, Field } from \"formik\";\nimport axios from \"axios\";\nimport Router from 'next/router';\nimport jwt from 'jsonwebtoken';\n\nfunction Login() {\n  let loginDetails = {\n    username: \"\",\n    password: \"\"\n  };\n  let errorMessage = \"\";\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"jsx-2874539724\" + \" \" + \"d-flex justify-content-center\",\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        className: \"jsx-2874539724\",\n        children: \"DPSM-QA-PORTAL\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 17,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\",\n        className: \"jsx-2874539724\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 19,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n        src: \"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js\",\n        className: \"jsx-2874539724\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 20,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n        src: \"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js\",\n        className: \"jsx-2874539724\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n        src: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js\",\n        className: \"jsx-2874539724\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"jsx-2874539724\" + \" \" + \"jumbotron\",\n      children: /*#__PURE__*/_jsxDEV(Formik, {\n        initialValues: loginDetails,\n        onSubmit: async values => {\n          // let token = null\n          // const tokenRes = await axios.post(\"http://localhost:3001/api/login\", {\n          //   upemail: `${values.username}`,\n          //   password: `${values.password}`\n          // })\n          // console.log(tokenRes)\n          // if(tokenRes.data.success) {\n          //   Router.push('/faculty')\n          // } else {\n          //   let alert = document.getElementById(\"alert\")\n          //   alert.setAttribute(\"style\", \"visibility: visible\");\n          //   values.username=\"\"\n          //   values.password=\"\"\n          // }\n          try {\n            let token = null;\n            const tokenRes = await axios.post(\"http://localhost:3001/api/login\", {\n              upemail: `${values.username}`,\n              password: `${values.password}`\n            });\n\n            if (tokenRes.data.success) {\n              token = jwt.decode(tokenRes.data.result.token);\n              document.cookie = \"token =\" + token;\n              let role = token.role;\n\n              if (role == 1) {\n                // faculty \n                Router.push({\n                  pathname: '/faculty',\n                  query: {\n                    role: 1\n                  }\n                });\n              } else if (role == 2 || role == 3) {\n                // unit head or dept. chair\n                Router.push('/faculty');\n              }\n            } else {\n              window.alert('something wrong');\n            }\n          } catch (err) {\n            console.error(err.response.data.errors[0].message);\n            errorMessage = err.response.data.errors[0].message;\n            let alert = document.getElementById(\"alert\");\n            alert.setAttribute(\"style\", \"visibility: visible\");\n            values.username = \"\";\n            values.password = \"\";\n            return err;\n          }\n        },\n        children: ({\n          values,\n          errors,\n          touched,\n          isSubmitting\n        }) => /*#__PURE__*/_jsxDEV(Form, {\n          action: \"\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            role: \"alert\",\n            id: \"alert\",\n            className: \"jsx-2874539724\" + \" \" + \"alert alert-danger\",\n            children: errorMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"email\",\n            className: \"jsx-2874539724\",\n            children: \"UP Email:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Field, {\n            className: \"form-control\",\n            type: \"text\",\n            id: \"username\",\n            name: \"username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"password\",\n            className: \"jsx-2874539724\",\n            children: \"Password:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Field, {\n            className: \"form-control\",\n            type: \"password\",\n            id: \"password\",\n            name: \"password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {\n            className: \"jsx-2874539724\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: isSubmitting,\n            className: \"jsx-2874539724\" + \" \" + \"btn btn-primary\",\n            children: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 2\n    }, this), /*#__PURE__*/_jsxDEV(_JSXStyle, {\n      id: \"2874539724\",\n      children: \".d-flex.jsx-2874539724{min-height:100%;min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}#alert.jsx-2874539724{visibility:hidden;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQWppIE1hZ2xhbnF1ZVxcRGVza3RvcFxcZHBzbS1xYS1wb3J0YWxcXHBhZ2VzXFxpbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFxR2EsQUFHb0IsQUFPSyxnQkFORixFQU9sQixlQUxjLDBFQUNNLDZGQUN0QiIsImZpbGUiOiJDOlxcVXNlcnNcXEFqaSBNYWdsYW5xdWVcXERlc2t0b3BcXGRwc20tcWEtcG9ydGFsXFxwYWdlc1xcaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnXHJcbmltcG9ydCBIZWFkIGZyb20gJ25leHQvaGVhZCdcclxuaW1wb3J0IHsgRm9ybWlrLCBGb3JtLCBGaWVsZCB9IGZyb20gXCJmb3JtaWtcIlxyXG5pbXBvcnQgYXhpb3MgZnJvbSBcImF4aW9zXCJcclxuaW1wb3J0IFJvdXRlciBmcm9tICduZXh0L3JvdXRlcidcclxuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nXHJcblxyXG5mdW5jdGlvbiBMb2dpbigpIHtcclxuICBsZXQgbG9naW5EZXRhaWxzID0ge1xyXG4gICAgdXNlcm5hbWU6IFwiXCIsXHJcbiAgICBwYXNzd29yZDogXCJcIixcclxuICB9XHJcbiAgbGV0IGVycm9yTWVzc2FnZSA9IFwiXCJcclxuICAgIHJldHVybiAoXHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWUgPSBcImQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCI+XHJcblx0XHQ8SGVhZD5cclxuICAgICAgICAgICAgICAgIDx0aXRsZT5EUFNNLVFBLVBPUlRBTDwvdGl0bGU+XHJcbiAgICAgICAgICAgICAgICB7LyogPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGhyZWY9XCJodHRwczovL3N0YWNrcGF0aC5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC80LjMuMS9jc3MvYm9vdHN0cmFwLm1pbi5jc3NcIiBpbnRlZ3JpdHk9XCJzaGEzODQtZ2dPeVIwaVhDYk1RdjNYaXBtYTM0TUQrZEgvMWZRNzg0L2o2Y1kvaUpUUVVPaGNXcjd4OUp2b1J4VDJNWncxVFwiIGNyb3Nzb3JpZ2luPVwiYW5vbnltb3VzXCI+PC9saW5rPiAqL31cclxuICAgICAgICAgICAgICAgIDxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBocmVmPVwiaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvNC41LjIvY3NzL2Jvb3RzdHJhcC5taW4uY3NzXCIgLz5cclxuICAgICAgICAgICAgICAgIDxzY3JpcHQgc3JjPVwiaHR0cHM6Ly9hamF4Lmdvb2dsZWFwaXMuY29tL2FqYXgvbGlicy9qcXVlcnkvMy41LjEvanF1ZXJ5Lm1pbi5qc1wiPjwvc2NyaXB0PlxyXG4gICAgICAgICAgICAgICAgPHNjcmlwdCBzcmM9XCJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9wb3BwZXIuanMvMS4xNi4wL3VtZC9wb3BwZXIubWluLmpzXCI+PC9zY3JpcHQ+XHJcbiAgICAgICAgICAgICAgICA8c2NyaXB0IHNyYz1cImh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vYm9vdHN0cmFwLzQuNS4yL2pzL2Jvb3RzdHJhcC5taW4uanNcIj48L3NjcmlwdD5cclxuICAgICAgICAgICAgPC9IZWFkPlxyXG5cdDxkaXYgY2xhc3NOYW1lID0gXCJqdW1ib3Ryb25cIj5cclxuICAgICAgICAgIDxGb3JtaWtcclxuICAgICAgICAgICAgaW5pdGlhbFZhbHVlcz17bG9naW5EZXRhaWxzfVxyXG4gICAgICAgICAgICBvblN1Ym1pdD17YXN5bmMgKHZhbHVlcykgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAvLyBsZXQgdG9rZW4gPSBudWxsXHJcbiAgICAgICAgICAgICAgLy8gY29uc3QgdG9rZW5SZXMgPSBhd2FpdCBheGlvcy5wb3N0KFwiaHR0cDovL2xvY2FsaG9zdDozMDAxL2FwaS9sb2dpblwiLCB7XHJcbiAgICAgICAgICAgICAgLy8gICB1cGVtYWlsOiBgJHt2YWx1ZXMudXNlcm5hbWV9YCxcclxuICAgICAgICAgICAgICAvLyAgIHBhc3N3b3JkOiBgJHt2YWx1ZXMucGFzc3dvcmR9YFxyXG4gICAgICAgICAgICAgIC8vIH0pXHJcblxyXG4gICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRva2VuUmVzKVxyXG5cclxuICAgICAgICAgICAgICAvLyBpZih0b2tlblJlcy5kYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAvLyAgIFJvdXRlci5wdXNoKCcvZmFjdWx0eScpXHJcbiAgICAgICAgICAgICAgLy8gfSBlbHNlIHtcclxuICAgICAgICAgICAgICAvLyAgIGxldCBhbGVydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWxlcnRcIilcclxuICAgICAgICAgICAgICAvLyAgIGFsZXJ0LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwidmlzaWJpbGl0eTogdmlzaWJsZVwiKTtcclxuICAgICAgICAgICAgICAvLyAgIHZhbHVlcy51c2VybmFtZT1cIlwiXHJcbiAgICAgICAgICAgICAgLy8gICB2YWx1ZXMucGFzc3dvcmQ9XCJcIlxyXG4gICAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGxldCB0b2tlbiA9IG51bGxcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuUmVzID0gYXdhaXQgYXhpb3MucG9zdChcImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMS9hcGkvbG9naW5cIiwge1xyXG4gICAgICAgICAgICAgICAgICB1cGVtYWlsOiBgJHt2YWx1ZXMudXNlcm5hbWV9YCxcclxuICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGAke3ZhbHVlcy5wYXNzd29yZH1gXHJcbiAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgIGlmKHRva2VuUmVzLmRhdGEuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICB0b2tlbiA9IGp3dC5kZWNvZGUodG9rZW5SZXMuZGF0YS5yZXN1bHQudG9rZW4pXHJcbiAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IFwidG9rZW4gPVwiICsgdG9rZW5cclxuICAgICAgICAgICAgICAgICAgbGV0IHJvbGUgPSB0b2tlbi5yb2xlXHJcbiAgICAgICAgICAgICAgICAgIGlmKHJvbGUgPT0gMSkgeyAvLyBmYWN1bHR5IFxyXG4gICAgICAgICAgICAgICAgICAgIFJvdXRlci5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgIHBhdGhuYW1lOiAnL2ZhY3VsdHknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgcXVlcnk6IHsgcm9sZTogMSB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocm9sZSA9PSAyIHx8IHJvbGUgPT0gMykgeyAvLyB1bml0IGhlYWQgb3IgZGVwdC4gY2hhaXJcclxuICAgICAgICAgICAgICAgICAgICBSb3V0ZXIucHVzaCgnL2ZhY3VsdHknKVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICB3aW5kb3cuYWxlcnQoJ3NvbWV0aGluZyB3cm9uZycpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVyci5yZXNwb25zZS5kYXRhLmVycm9ycy5bMF0ubWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IGVyci5yZXNwb25zZS5kYXRhLmVycm9ycy5bMF0ubWVzc2FnZVxyXG4gICAgICAgICAgICAgICAgbGV0IGFsZXJ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbGVydFwiKVxyXG4gICAgICAgICAgICAgICAgYWxlcnQuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJ2aXNpYmlsaXR5OiB2aXNpYmxlXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFsdWVzLnVzZXJuYW1lPVwiXCJcclxuICAgICAgICAgICAgICAgIHZhbHVlcy5wYXNzd29yZD1cIlwiXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZXJyXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9fVxyXG4gICAgICAgICAgPlxyXG4gICAgICAgICAgICB7KHsgdmFsdWVzLCBlcnJvcnMsIHRvdWNoZWQsIGlzU3VibWl0dGluZyB9KSA9PiAoXHJcbiAgICAgICAgICAgICAgPEZvcm0gYWN0aW9uPVwiXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsZXJ0IGFsZXJ0LWRhbmdlclwiIHJvbGU9XCJhbGVydFwiIGlkPVwiYWxlcnRcIj5cclxuICAgICAgICAgICAgICAgICAge2Vycm9yTWVzc2FnZX1cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJlbWFpbFwiPlVQIEVtYWlsOjwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICA8RmllbGQgY2xhc3NOYW1lID0gXCJmb3JtLWNvbnRyb2xcIiB0eXBlPVwidGV4dFwiIGlkPVwidXNlcm5hbWVcIiBuYW1lPVwidXNlcm5hbWVcIiAvPlxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICA8bGFiZWwgaHRtbEZvcj1cInBhc3N3b3JkXCI+UGFzc3dvcmQ6PC9sYWJlbD5cclxuICAgICAgICAgICAgICAgIDxGaWVsZCBjbGFzc05hbWUgPSBcImZvcm0tY29udHJvbFwiIHR5cGU9XCJwYXNzd29yZFwiIGlkPVwicGFzc3dvcmRcIiBuYW1lPVwicGFzc3dvcmRcIiAvPlxyXG5cdFx0ICAgICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgIHR5cGUgPSBcInN1Ym1pdFwiXHJcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZSA9IFwiYnRuIGJ0bi1wcmltYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgZGlzYWJsZWQgPSB7aXNTdWJtaXR0aW5nfVxyXG4gICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICBTdWJtaXRcclxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgey8qPExpbmsgaHJlZj1cIi9mYWN1bHR5XCI+PGlucHV0IHR5cGU9XCJzdWJtaXRcIiBjbGFzc05hbWUgPSBcImJ0biBidG4tcHJpbWFyeVwiIHZhbHVlPVwiTG9naW5cIj48L2lucHV0PjwvTGluaz4qL31cclxuICAgICAgICAgICAgICA8L0Zvcm0+XHJcbiAgICAgICAgICAgICl9XHJcbiAgICAgICAgICA8L0Zvcm1paz5cclxuXHQ8L2Rpdj5cclxuXHQ8c3R5bGUganN4PntgXHJcblx0XHQuZC1mbGV4e1xyXG5cdFx0XHRtaW4taGVpZ2h0OiAxMDAlO1xyXG4gIFx0XHRcdG1pbi1oZWlnaHQ6IDEwMHZoOyBcclxuXHJcbiAgXHRcdFx0ZGlzcGxheTogZmxleDtcclxuICBcdFx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xyXG5cdFx0fVxyXG4gICAgI2FsZXJ0IHtcclxuICAgICAgdmlzaWJpbGl0eTogaGlkZGVuO1xyXG4gICAgfVxyXG5cdGB9PC9zdHlsZT5cclxuICAgICAgICA8L2Rpdj5cclxuICAgIClcclxuICB9XHJcbiAgXHJcbiAgZXhwb3J0IGRlZmF1bHQgTG9naW5cclxuIl19 */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\Aji Maglanque\\\\\\\\Desktop\\\\\\\\dpsm-qa-portal\\\\\\\\pages\\\\\\\\index.js */\"\n    }, void 0, false, void 0, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 15,\n    columnNumber: 9\n  }, this);\n}\n\nexport default Login;","map":{"version":3,"sources":["C:/Users/Aji Maglanque/Desktop/dpsm-qa-portal/pages/index.js"],"names":["Link","Head","Formik","Form","Field","axios","Router","jwt","Login","loginDetails","username","password","errorMessage","values","token","tokenRes","post","upemail","data","success","decode","result","document","cookie","role","push","pathname","query","window","alert","err","console","error","response","errors","message","getElementById","setAttribute","touched","isSubmitting"],"mappings":"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","sourcesContent":["import Link from 'next/link'\r\nimport Head from 'next/head'\r\nimport { Formik, Form, Field } from \"formik\"\r\nimport axios from \"axios\"\r\nimport Router from 'next/router'\r\nimport jwt from 'jsonwebtoken'\r\n\r\nfunction Login() {\r\n  let loginDetails = {\r\n    username: \"\",\r\n    password: \"\",\r\n  }\r\n  let errorMessage = \"\"\r\n    return (\r\n        <div className = \"d-flex justify-content-center\">\r\n\t\t<Head>\r\n                <title>DPSM-QA-PORTAL</title>\r\n                {/* <link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css\" integrity=\"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T\" crossorigin=\"anonymous\"></link> */}\r\n                <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\" />\r\n                <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js\"></script>\r\n                <script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js\"></script>\r\n                <script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js\"></script>\r\n            </Head>\r\n\t<div className = \"jumbotron\">\r\n          <Formik\r\n            initialValues={loginDetails}\r\n            onSubmit={async (values) => {\r\n\r\n              // let token = null\r\n              // const tokenRes = await axios.post(\"http://localhost:3001/api/login\", {\r\n              //   upemail: `${values.username}`,\r\n              //   password: `${values.password}`\r\n              // })\r\n\r\n              // console.log(tokenRes)\r\n\r\n              // if(tokenRes.data.success) {\r\n              //   Router.push('/faculty')\r\n              // } else {\r\n              //   let alert = document.getElementById(\"alert\")\r\n              //   alert.setAttribute(\"style\", \"visibility: visible\");\r\n              //   values.username=\"\"\r\n              //   values.password=\"\"\r\n              // }\r\n\r\n              try {\r\n                let token = null\r\n                const tokenRes = await axios.post(\"http://localhost:3001/api/login\", {\r\n                  upemail: `${values.username}`,\r\n                  password: `${values.password}`\r\n                })\r\n\r\n                if(tokenRes.data.success) {\r\n                  token = jwt.decode(tokenRes.data.result.token)\r\n                  document.cookie = \"token =\" + token\r\n                  let role = token.role\r\n                  if(role == 1) { // faculty \r\n                    Router.push({\r\n                      pathname: '/faculty',\r\n                      query: { role: 1 },\r\n                    })\r\n                  } else if (role == 2 || role == 3) { // unit head or dept. chair\r\n                    Router.push('/faculty')\r\n                  }\r\n                } else {\r\n                  window.alert('something wrong')\r\n                }\r\n              } catch (err) {\r\n                console.error(err.response.data.errors.[0].message)\r\n                errorMessage = err.response.data.errors.[0].message\r\n                let alert = document.getElementById(\"alert\")\r\n                alert.setAttribute(\"style\", \"visibility: visible\");\r\n                values.username=\"\"\r\n                values.password=\"\"\r\n                return err\r\n              }\r\n            }}\r\n          >\r\n            {({ values, errors, touched, isSubmitting }) => (\r\n              <Form action=\"\">\r\n                <div className=\"alert alert-danger\" role=\"alert\" id=\"alert\">\r\n                  {errorMessage}\r\n                </div>\r\n                <label htmlFor=\"email\">UP Email:</label>\r\n                <Field className = \"form-control\" type=\"text\" id=\"username\" name=\"username\" />\r\n                \r\n                <label htmlFor=\"password\">Password:</label>\r\n                <Field className = \"form-control\" type=\"password\" id=\"password\" name=\"password\" />\r\n\t\t            <br />\r\n                <button\r\n                  type = \"submit\"\r\n                  className = \"btn btn-primary\"\r\n                  disabled = {isSubmitting}\r\n                >\r\n                  Submit\r\n                </button>\r\n                {/*<Link href=\"/faculty\"><input type=\"submit\" className = \"btn btn-primary\" value=\"Login\"></input></Link>*/}\r\n              </Form>\r\n            )}\r\n          </Formik>\r\n\t</div>\r\n\t<style jsx>{`\r\n\t\t.d-flex{\r\n\t\t\tmin-height: 100%;\r\n  \t\t\tmin-height: 100vh; \r\n\r\n  \t\t\tdisplay: flex;\r\n  \t\t\talign-items: center;\r\n\t\t}\r\n    #alert {\r\n      visibility: hidden;\r\n    }\r\n\t`}</style>\r\n        </div>\r\n    )\r\n  }\r\n  \r\n  export default Login\r\n"]},"metadata":{},"sourceType":"module"}