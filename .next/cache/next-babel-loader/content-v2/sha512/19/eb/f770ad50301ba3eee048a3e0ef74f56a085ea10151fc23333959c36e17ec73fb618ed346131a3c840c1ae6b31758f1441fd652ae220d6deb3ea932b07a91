{"ast":null,"code":"import _regeneratorRuntime from \"D:/Bod/dpsm-qa-portal/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/Bod/dpsm-qa-portal/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _slicedToArray from \"D:/Bod/dpsm-qa-portal/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"D:\\\\Bod\\\\dpsm-qa-portal\\\\pages\\\\login.js\",\n    _s = $RefreshSig$();\n\nimport _JSXStyle from \"styled-jsx/style\";\nimport Link from 'next/link';\nimport Head from 'next/head';\nimport { Formik, Form, Field } from \"formik\";\nimport axios from \"axios\";\nimport Router from 'next/router';\nimport jwt from 'jsonwebtoken';\nimport { useCookies } from \"react-cookie\";\n\nfunction Login() {\n  _s();\n\n  var _this = this;\n\n  var loginDetails = {\n    username: \"\",\n    password: \"\"\n  };\n  var errorMessage = \"\";\n\n  var _useCookies = useCookies([\"user\"]),\n      _useCookies2 = _slicedToArray(_useCookies, 2),\n      cookie = _useCookies2[0],\n      setCookie = _useCookies2[1];\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"jsx-2874539724\" + \" \" + \"d-flex justify-content-center\",\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        className: \"jsx-2874539724\",\n        children: \"DPSM-QA-PORTAL\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 20,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\",\n        className: \"jsx-2874539724\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n        src: \"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js\",\n        className: \"jsx-2874539724\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 23,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n        src: \"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js\",\n        className: \"jsx-2874539724\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 24,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n        src: \"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js\",\n        className: \"jsx-2874539724\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"jsx-2874539724\" + \" \" + \"jumbotron\",\n      children: /*#__PURE__*/_jsxDEV(Formik, {\n        initialValues: loginDetails,\n        onSubmit: /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values) {\n            var token, tokenRes, role, alert;\n            return _regeneratorRuntime.wrap(function _callee$(_context) {\n              while (1) {\n                switch (_context.prev = _context.next) {\n                  case 0:\n                    _context.prev = 0;\n                    token = null;\n                    _context.next = 4;\n                    return axios.post(\"http://localhost:3001/api/login\", {\n                      upemail: \"\".concat(values.username),\n                      password: \"\".concat(values.password)\n                    });\n\n                  case 4:\n                    tokenRes = _context.sent;\n\n                    if (tokenRes.data.success) {\n                      setCookie(\"user\", tokenRes.data.result.token, {\n                        path: \"/\",\n                        maxAge: 3600,\n                        // Expires after 1hr\n                        sameSite: true\n                      });\n                      token = jwt.decode(tokenRes.data.result.token);\n                      role = token.role;\n\n                      if (role == 1) {\n                        // faculty \n                        Router.push('/faculty/basic-info');\n                      } else if (role == 2 || role == 3) {\n                        // unit head or dept. chair\n                        Router.push('/faculty');\n                      }\n                    } else {\n                      window.alert('something wrong');\n                    }\n\n                    _context.next = 17;\n                    break;\n\n                  case 8:\n                    _context.prev = 8;\n                    _context.t0 = _context[\"catch\"](0);\n                    console.error(_context.t0.response.data.errors[0].message);\n                    errorMessage = _context.t0.response.data.errors[0].message;\n                    alert = document.getElementById(\"alert\");\n                    alert.setAttribute(\"style\", \"visibility: visible\");\n                    values.username = \"\";\n                    values.password = \"\";\n                    return _context.abrupt(\"return\", _context.t0);\n\n                  case 17:\n                  case \"end\":\n                    return _context.stop();\n                }\n              }\n            }, _callee, null, [[0, 8]]);\n          }));\n\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }(),\n        children: function children(_ref2) {\n          var values = _ref2.values,\n              errors = _ref2.errors,\n              touched = _ref2.touched,\n              isSubmitting = _ref2.isSubmitting;\n          return /*#__PURE__*/_jsxDEV(Form, {\n            action: \"\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              role: \"alert\",\n              id: \"alert\",\n              className: \"jsx-2874539724\" + \" \" + \"alert alert-danger\",\n              children: errorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 68,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"email\",\n              className: \"jsx-2874539724\",\n              children: \"UP Email:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(Field, {\n              className: \"form-control\",\n              type: \"text\",\n              id: \"username\",\n              name: \"username\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 72,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"password\",\n              className: \"jsx-2874539724\",\n              children: \"Password:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(Field, {\n              className: \"form-control\",\n              type: \"password\",\n              id: \"password\",\n              name: \"password\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(\"br\", {\n              className: \"jsx-2874539724\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 76,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              disabled: isSubmitting,\n              className: \"jsx-2874539724\" + \" \" + \"btn btn-primary\",\n              children: \"Submit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 15\n          }, _this);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 2\n    }, this), /*#__PURE__*/_jsxDEV(_JSXStyle, {\n      id: \"2874539724\",\n      children: \".d-flex.jsx-2874539724{min-height:100%;min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}#alert.jsx-2874539724{visibility:hidden;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFxCb2RcXGRwc20tcWEtcG9ydGFsXFxwYWdlc1xcbG9naW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBd0ZhLEFBR29CLEFBT0ssZ0JBTkYsRUFPbEIsZUFMYywwRUFDTSw2RkFDdEIiLCJmaWxlIjoiRDpcXEJvZFxcZHBzbS1xYS1wb3J0YWxcXHBhZ2VzXFxsb2dpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMaW5rIGZyb20gJ25leHQvbGluaydcclxuaW1wb3J0IEhlYWQgZnJvbSAnbmV4dC9oZWFkJ1xyXG5pbXBvcnQgeyBGb3JtaWssIEZvcm0sIEZpZWxkIH0gZnJvbSBcImZvcm1pa1wiXHJcbmltcG9ydCBheGlvcyBmcm9tIFwiYXhpb3NcIlxyXG5pbXBvcnQgUm91dGVyIGZyb20gJ25leHQvcm91dGVyJ1xyXG5pbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbidcclxuaW1wb3J0IHsgdXNlQ29va2llcyB9IGZyb20gXCJyZWFjdC1jb29raWVcIlxyXG5cclxuZnVuY3Rpb24gTG9naW4oKSB7XHJcbiAgbGV0IGxvZ2luRGV0YWlscyA9IHtcclxuICAgIHVzZXJuYW1lOiBcIlwiLFxyXG4gICAgcGFzc3dvcmQ6IFwiXCIsXHJcbiAgfVxyXG4gIGxldCBlcnJvck1lc3NhZ2UgPSBcIlwiXHJcblxyXG4gIGNvbnN0IFtjb29raWUsIHNldENvb2tpZV0gPSB1c2VDb29raWVzKFtcInVzZXJcIl0pXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lID0gXCJkLWZsZXgganVzdGlmeS1jb250ZW50LWNlbnRlclwiPlxyXG5cdFx0PEhlYWQ+XHJcbiAgICAgICAgICAgICAgICA8dGl0bGU+RFBTTS1RQS1QT1JUQUw8L3RpdGxlPlxyXG4gICAgICAgICAgICAgICAgey8qIDxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiBocmVmPVwiaHR0cHM6Ly9zdGFja3BhdGguYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvNC4zLjEvY3NzL2Jvb3RzdHJhcC5taW4uY3NzXCIgaW50ZWdyaXR5PVwic2hhMzg0LWdnT3lSMGlYQ2JNUXYzWGlwbWEzNE1EK2RILzFmUTc4NC9qNmNZL2lKVFFVT2hjV3I3eDlKdm9SeFQyTVp3MVRcIiBjcm9zc29yaWdpbj1cImFub255bW91c1wiPjwvbGluaz4gKi99XHJcbiAgICAgICAgICAgICAgICA8bGluayByZWw9XCJzdHlsZXNoZWV0XCIgaHJlZj1cImh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vYm9vdHN0cmFwLzQuNS4yL2Nzcy9ib290c3RyYXAubWluLmNzc1wiIC8+XHJcbiAgICAgICAgICAgICAgICA8c2NyaXB0IHNyYz1cImh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzMuNS4xL2pxdWVyeS5taW4uanNcIj48L3NjcmlwdD5cclxuICAgICAgICAgICAgICAgIDxzY3JpcHQgc3JjPVwiaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcG9wcGVyLmpzLzEuMTYuMC91bWQvcG9wcGVyLm1pbi5qc1wiPjwvc2NyaXB0PlxyXG4gICAgICAgICAgICAgICAgPHNjcmlwdCBzcmM9XCJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC80LjUuMi9qcy9ib290c3RyYXAubWluLmpzXCI+PC9zY3JpcHQ+XHJcbiAgICAgICAgICAgIDwvSGVhZD5cclxuXHQ8ZGl2IGNsYXNzTmFtZSA9IFwianVtYm90cm9uXCI+XHJcbiAgICAgICAgICA8Rm9ybWlrXHJcbiAgICAgICAgICAgIGluaXRpYWxWYWx1ZXM9e2xvZ2luRGV0YWlsc31cclxuICAgICAgICAgICAgb25TdWJtaXQ9e2FzeW5jICh2YWx1ZXMpID0+IHtcclxuICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBsZXQgdG9rZW4gPSBudWxsXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0b2tlblJlcyA9IGF3YWl0IGF4aW9zLnBvc3QoXCJodHRwOi8vbG9jYWxob3N0OjMwMDEvYXBpL2xvZ2luXCIsIHtcclxuICAgICAgICAgICAgICAgICAgdXBlbWFpbDogYCR7dmFsdWVzLnVzZXJuYW1lfWAsXHJcbiAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBgJHt2YWx1ZXMucGFzc3dvcmR9YFxyXG4gICAgICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgICAgICBpZih0b2tlblJlcy5kYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgc2V0Q29va2llKFwidXNlclwiLCB0b2tlblJlcy5kYXRhLnJlc3VsdC50b2tlbiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IFwiL1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIG1heEFnZTogMzYwMCwgLy8gRXhwaXJlcyBhZnRlciAxaHJcclxuICAgICAgICAgICAgICAgICAgICBzYW1lU2l0ZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgdG9rZW4gPSBqd3QuZGVjb2RlKHRva2VuUmVzLmRhdGEucmVzdWx0LnRva2VuKVxyXG4gICAgICAgICAgICAgICAgICBsZXQgcm9sZSA9IHRva2VuLnJvbGVcclxuICAgICAgICAgICAgICAgICAgaWYocm9sZSA9PSAxKSB7IC8vIGZhY3VsdHkgXHJcbiAgICAgICAgICAgICAgICAgICAgUm91dGVyLnB1c2goJy9mYWN1bHR5L2Jhc2ljLWluZm8nKVxyXG4gICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJvbGUgPT0gMiB8fCByb2xlID09IDMpIHsgLy8gdW5pdCBoZWFkIG9yIGRlcHQuIGNoYWlyXHJcbiAgICAgICAgICAgICAgICAgICAgUm91dGVyLnB1c2goJy9mYWN1bHR5JylcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KCdzb21ldGhpbmcgd3JvbmcnKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIucmVzcG9uc2UuZGF0YS5lcnJvcnMuWzBdLm1lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBlcnIucmVzcG9uc2UuZGF0YS5lcnJvcnMuWzBdLm1lc3NhZ2VcclxuICAgICAgICAgICAgICAgIGxldCBhbGVydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWxlcnRcIilcclxuICAgICAgICAgICAgICAgIGFsZXJ0LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwidmlzaWJpbGl0eTogdmlzaWJsZVwiKTtcclxuICAgICAgICAgICAgICAgIHZhbHVlcy51c2VybmFtZT1cIlwiXHJcbiAgICAgICAgICAgICAgICB2YWx1ZXMucGFzc3dvcmQ9XCJcIlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVyclxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfX1cclxuICAgICAgICAgID5cclxuICAgICAgICAgICAgeyh7IHZhbHVlcywgZXJyb3JzLCB0b3VjaGVkLCBpc1N1Ym1pdHRpbmcgfSkgPT4gKFxyXG4gICAgICAgICAgICAgIDxGb3JtIGFjdGlvbj1cIlwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGVydCBhbGVydC1kYW5nZXJcIiByb2xlPVwiYWxlcnRcIiBpZD1cImFsZXJ0XCI+XHJcbiAgICAgICAgICAgICAgICAgIHtlcnJvck1lc3NhZ2V9XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxsYWJlbCBodG1sRm9yPVwiZW1haWxcIj5VUCBFbWFpbDo8L2xhYmVsPlxyXG4gICAgICAgICAgICAgICAgPEZpZWxkIGNsYXNzTmFtZSA9IFwiZm9ybS1jb250cm9sXCIgdHlwZT1cInRleHRcIiBpZD1cInVzZXJuYW1lXCIgbmFtZT1cInVzZXJuYW1lXCIgLz5cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9XCJwYXNzd29yZFwiPlBhc3N3b3JkOjwvbGFiZWw+XHJcbiAgICAgICAgICAgICAgICA8RmllbGQgY2xhc3NOYW1lID0gXCJmb3JtLWNvbnRyb2xcIiB0eXBlPVwicGFzc3dvcmRcIiBpZD1cInBhc3N3b3JkXCIgbmFtZT1cInBhc3N3b3JkXCIgLz5cclxuXHRcdCAgICAgICAgICAgIDxiciAvPlxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICB0eXBlID0gXCJzdWJtaXRcIlxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWUgPSBcImJ0biBidG4tcHJpbWFyeVwiXHJcbiAgICAgICAgICAgICAgICAgIGRpc2FibGVkID0ge2lzU3VibWl0dGluZ31cclxuICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgU3VibWl0XHJcbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgIHsvKjxMaW5rIGhyZWY9XCIvZmFjdWx0eVwiPjxpbnB1dCB0eXBlPVwic3VibWl0XCIgY2xhc3NOYW1lID0gXCJidG4gYnRuLXByaW1hcnlcIiB2YWx1ZT1cIkxvZ2luXCI+PC9pbnB1dD48L0xpbms+Ki99XHJcbiAgICAgICAgICAgICAgPC9Gb3JtPlxyXG4gICAgICAgICAgICApfVxyXG4gICAgICAgICAgPC9Gb3JtaWs+XHJcblx0PC9kaXY+XHJcblx0PHN0eWxlIGpzeD57YFxyXG5cdFx0LmQtZmxleHtcclxuXHRcdFx0bWluLWhlaWdodDogMTAwJTtcclxuICBcdFx0XHRtaW4taGVpZ2h0OiAxMDB2aDsgXHJcblxyXG4gIFx0XHRcdGRpc3BsYXk6IGZsZXg7XHJcbiAgXHRcdFx0YWxpZ24taXRlbXM6IGNlbnRlcjtcclxuXHRcdH1cclxuICAgICNhbGVydCB7XHJcbiAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjtcclxuICAgIH1cclxuXHRgfTwvc3R5bGU+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICApXHJcbiAgfVxyXG4gIFxyXG4gIGV4cG9ydCBkZWZhdWx0IExvZ2luXHJcbiJdfQ== */\\n/*@ sourceURL=D:\\\\\\\\Bod\\\\\\\\dpsm-qa-portal\\\\\\\\pages\\\\\\\\login.js */\"\n    }, void 0, false, void 0, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 18,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Login, \"rWtr2pzGlVObhxILlGDRXrEMlRk=\", false, function () {\n  return [useCookies];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["D:/Bod/dpsm-qa-portal/pages/login.js"],"names":["Link","Head","Formik","Form","Field","axios","Router","jwt","useCookies","Login","loginDetails","username","password","errorMessage","cookie","setCookie","values","token","post","upemail","tokenRes","data","success","result","path","maxAge","sameSite","decode","role","push","window","alert","console","error","response","errors","message","document","getElementById","setAttribute","touched","isSubmitting"],"mappings":"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","sourcesContent":["import Link from 'next/link'\r\nimport Head from 'next/head'\r\nimport { Formik, Form, Field } from \"formik\"\r\nimport axios from \"axios\"\r\nimport Router from 'next/router'\r\nimport jwt from 'jsonwebtoken'\r\nimport { useCookies } from \"react-cookie\"\r\n\r\nfunction Login() {\r\n  let loginDetails = {\r\n    username: \"\",\r\n    password: \"\",\r\n  }\r\n  let errorMessage = \"\"\r\n\r\n  const [cookie, setCookie] = useCookies([\"user\"])\r\n    return (\r\n        <div className = \"d-flex justify-content-center\">\r\n\t\t<Head>\r\n                <title>DPSM-QA-PORTAL</title>\r\n                {/* <link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css\" integrity=\"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T\" crossorigin=\"anonymous\"></link> */}\r\n                <link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\" />\r\n                <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js\"></script>\r\n                <script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js\"></script>\r\n                <script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js\"></script>\r\n            </Head>\r\n\t<div className = \"jumbotron\">\r\n          <Formik\r\n            initialValues={loginDetails}\r\n            onSubmit={async (values) => {\r\n              try {\r\n                \r\n                let token = null\r\n                const tokenRes = await axios.post(\"http://localhost:3001/api/login\", {\r\n                  upemail: `${values.username}`,\r\n                  password: `${values.password}`\r\n                })\r\n\r\n                if(tokenRes.data.success) {\r\n                  setCookie(\"user\", tokenRes.data.result.token, {\r\n                    path: \"/\",\r\n                    maxAge: 3600, // Expires after 1hr\r\n                    sameSite: true,\r\n                  })\r\n                  token = jwt.decode(tokenRes.data.result.token)\r\n                  let role = token.role\r\n                  if(role == 1) { // faculty \r\n                    Router.push('/faculty/basic-info')\r\n                  } else if (role == 2 || role == 3) { // unit head or dept. chair\r\n                    Router.push('/faculty')\r\n                  }\r\n                } else {\r\n                  window.alert('something wrong')\r\n                }\r\n              } catch (err) {\r\n                console.error(err.response.data.errors.[0].message)\r\n                errorMessage = err.response.data.errors.[0].message\r\n                let alert = document.getElementById(\"alert\")\r\n                alert.setAttribute(\"style\", \"visibility: visible\");\r\n                values.username=\"\"\r\n                values.password=\"\"\r\n                return err\r\n              }\r\n            }}\r\n          >\r\n            {({ values, errors, touched, isSubmitting }) => (\r\n              <Form action=\"\">\r\n                <div className=\"alert alert-danger\" role=\"alert\" id=\"alert\">\r\n                  {errorMessage}\r\n                </div>\r\n                <label htmlFor=\"email\">UP Email:</label>\r\n                <Field className = \"form-control\" type=\"text\" id=\"username\" name=\"username\" />\r\n                \r\n                <label htmlFor=\"password\">Password:</label>\r\n                <Field className = \"form-control\" type=\"password\" id=\"password\" name=\"password\" />\r\n\t\t            <br />\r\n                <button\r\n                  type = \"submit\"\r\n                  className = \"btn btn-primary\"\r\n                  disabled = {isSubmitting}\r\n                >\r\n                  Submit\r\n                </button>\r\n                {/*<Link href=\"/faculty\"><input type=\"submit\" className = \"btn btn-primary\" value=\"Login\"></input></Link>*/}\r\n              </Form>\r\n            )}\r\n          </Formik>\r\n\t</div>\r\n\t<style jsx>{`\r\n\t\t.d-flex{\r\n\t\t\tmin-height: 100%;\r\n  \t\t\tmin-height: 100vh; \r\n\r\n  \t\t\tdisplay: flex;\r\n  \t\t\talign-items: center;\r\n\t\t}\r\n    #alert {\r\n      visibility: hidden;\r\n    }\r\n\t`}</style>\r\n        </div>\r\n    )\r\n  }\r\n  \r\n  export default Login\r\n"]},"metadata":{},"sourceType":"module"}